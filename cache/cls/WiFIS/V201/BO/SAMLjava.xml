<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="25">
<Class name="WiFIS.V201.BO.SAMLjava">
<Description>
Operación que invoca a un jar externo (proxySAML) para generar ticket SAML para WiFIS.</Description>
<Super>EnsLib.JavaGateway.AbstractOperation</Super>
<TimeCreated>63871,66598.896176</TimeCreated>

<Parameter name="SrcVer">
<Description>
Location and Revision of this file in Perforce (Auto-updating)</Description>
<Default>$Id: //custom_ccrs/_common/tools/Iberia/WiFIS/latest/cls/WiFIS/V201/BO/SAMLjava.xml#1 $</Default>
</Parameter>

<Parameter name="SETTINGS">
<Description>
Configurable settings for this operation.</Description>
<Default>ConfigurationFile:WiFIS, PropertiesFile:WiFIS, Address:Basic,Port:Basic,AdditionalPaths,ConnectTimeout,-ArchiveIO</Default>
</Parameter>

<Property name="ConfigurationFile">
<Description>
Ruta al fichero de configuración para generar ticket SAML.</Description>
<Type>%String</Type>
<Parameter name="MAXLEN"/>
</Property>

<Property name="PropertiesFile">
<Description>
Ruta al fichero de propiedades para generar ticket SAML.</Description>
<Type>%String</Type>
<Parameter name="MAXLEN"/>
</Property>

<Method name="OnMessage">
<FormalSpec>pRequest:Ens.StringContainer,*pResponse:Ens.StringContainer</FormalSpec>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	set ret = $$$OK
	
	try {
		set pResponse = ##class(Ens.StringContainer).%New()
		
		// abrir conexión Java Gateway
		#dim tJavaGateway as EnsLib.JavaGateway.JavaGateway
		$$$THROWONERROR(tSC, ..GetConnection(.tJavaGateway))
		
		// generar ticket 
		set pResponse.StringValue = ##class(hc3sa.saml.ProxyHC3SAML).getSAML(
		.tJavaGateway, // static. pasar conexión como 1er parámetro.
		..ConfigurationFile, 
		..PropertiesFile)

	} catch ex {
		set ret = ex.AsStatus()
	}
	quit ret
]]></Implementation>
</Method>
</Class>
</Export>
