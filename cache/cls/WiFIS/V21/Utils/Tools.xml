<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="25">
<Class name="WiFIS.V21.Utils.Tools">
<IncludeCode>Ensemble,%ZEN.ReportUtil</IncludeCode>
<Super>%RegisteredObject</Super>
<TimeCreated>63539,44345.419904</TimeCreated>

<Parameter name="SrcVer">
<Description>
Location and Revision of this file in Perforce (Auto-updating)</Description>
<Default>$Id: //custom_ccrs/_common/tools/Iberia/WiFIS/latest/cls/WiFIS/V21/Utils/Tools.xml#1 $</Default>
</Parameter>

<Parameter name="ZIP">
<Description>
Path of 7zip exe (used to build distribution package).</Description>
<Default>C:\Program Files\7-Zip\7zG.exe</Default>
</Parameter>

<Method name="MakeDist">
<Description><![CDATA[
Create a distribution package
pSourcePath - Path to directory containing source files (classes, xml, etc.)
pTargetPAth - Path where distribution package will be created.
<example>
set source="C:\isc\p4\custom_ccrs\_common\tools\Iberia\WiFIS\latest"
set target="C:\Temp\"
set sc=##class(WiFIS.V21.Utils.Tools).MakeDist(source,target,"WiFISEasyConnect_2.2_2014")
</example>]]></Description>
<ClassMethod>1</ClassMethod>
<FormalSpec>pSourcePath:%String,pTargetPath:%String,pDistName:%String=""</FormalSpec>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	set ret = $$$OK
	try {
		set version=##class(WiFIS.Info).#VERSION_"_"_##class(WiFIS.Info).#PORTING
		
		// normalize paths
		set source=##class(%File).NormalizeDirectory("", pSourcePath)
		set target=##class(%File).NormalizeDirectory("", pTargetPath)
		if ((source="")||(target="")) $$$ThrowStatus($$$ERROR($$$GeneralError,"source/target path incorrect"))
		
		// build zip file from source path excluding *.bak files
		set srcfiles = source_"*"
		if pDistName="" set pDistName="WiFISEasyConnect_"_version
		set distfile = target_pDistName_".zip"
		set cmd=""""_..#ZIP_""" a -tzip "_distfile_" "_srcfiles_" -mx=9 -xr!*.bak" 
		set err=$ZF(-1,cmd)
		if (err) $$$ThrowStatus($$$ERROR($$$GeneralError,"'"_cmd_"' returned error "_err))
	} catch ex {
		set ret = ex.AsStatus()
	}
	quit ret
]]></Implementation>
</Method>
</Class>
</Export>
